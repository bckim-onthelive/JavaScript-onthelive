<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OMOK4</title>
    <style>
        td {
            border: 2px solid black;
            width: 50px;
            height: 50px;
        }
        /* sup {
            font-size: 15px;
        } */

        .tdHeader {
            color: orange;
            vertical-align: middle;
            width: 2px;
            font-size: 30px;
            /* border-right: 2px solid black; */
            border: transparent;
        }
        .tdBody {
            color: white;
            font-size: 20px;
            border: black;
            padding-left: 20px;
        }

        
    </style>
</head>

<body>
    <button onclick="makeTable()" style="margin-bottom:10px">오목판 만들기</button>
    <button onclick="replay()" style="margin-bottom:10px">리플레이 확인하기</button>
    <br><br>
    <div style="position: relative;">
        <div style="width: flex; height: 1700px; background-color: blue; position: right; top: -10px; z-index: -1;">
        <div id="Main" style="position: flex; display: inline-block; padding-right: 30px; padding-bottom: 30px;">
            <table id="Table" style="border-collapse: collapse;"></table>
            <table id="Table2" style="border-collapse: seperate; position: absolute; top: -35px; left: -35px; border-spacing:25px 23px;"></table>
        </div>
            <div style="display:inline; position:absolute; margin-left: 300px; background-color: blue; color: white;">
                <h1>텐초목</h1>
                <span>10초안에 두지 않으면 기회는 상대편에게 ~</span>
                <br><br>
                <table style="border-collapse: collapse; width: 350px; height: 300px; background-color: blue;">
                    <tr>
                        <td rowspan="5" class="tdHeader">현<br>황</td>
                        <td class="tdBody" id="rightTop1">놓여진 돌의 개수 : 0개</td>
                    </tr>
                    <tr>
                        <td class="tdBody" id="rightTop2">백돌 : 0개</td>
                    </tr>
                    <tr>
                        <td class="tdBody" id="rightTop3">흑돌 : 0개</td>
                    </tr>
                    <tr>
                        <td class="tdBody" id="rightTop4">백돌소요시간</td>
                    </tr>
                    <tr">
                        <td class="tdBody" id="rightTop5">흑돌소요시간</td>
                    </tr>
                    <tr>
                        <td rowspan="3" class="tdHeader">다<br>음</td>
                        <td class="tdBody" id="rightBottom1">순서</td>
                    </tr>
                    <tr>
                        <td class="tdBody" id="rightBottom2">이번경과시간</td>
                    </tr>
                    <tr>
                        <td class="tdBody" id="rightBottom3">남은시간</td>
                    </tr>
                </table>
            </div>
        </div>
    </div>

<script>
    let blackStone = new Array();
    let whiteStone = new Array();

    let sittedStone = 0;
    let rudch = 0;
    let skach = 10;
    let whrudch = 0;
    let bkrudch = 0;

    rightTop4.innerHTML = "백돌소요시간 : " + whrudch + "초";
    rightTop5.innerHTML = "흑돌소요시간 : " + bkrudch + "초";
    rightBottom1.innerHTML = "순서 : 흑돌";
    rightBottom2.innerHTML = "이번경과시간 : 0초";
    rightBottom3.innerHTML = "남은시간 : 10초";

    let count = 1;
    let a = undefined;

    let handleId = 0;
    let getPlayTime = 0;
    let playTime = 0

    function replay() {
        // 여기 왜 테이블을 만드는건지 노이해
        makeCloneTable();
        console.log("됐냐");
    }

    function makeTable() {
        let row = prompt("몇 행을 원하는 가");
        let col = prompt("몇 열을 원하는 가");
        Main.style.backgroundColor = "#d37313";

        for (let i = 0; i < Number(row); i++) {
            let TR = document.createElement('tr');
            
            for (let j = 0; j < Number(col); j++) {
                let TD = document.createElement('td');
                
                if (j == 0) {
                    // i = 0 ~ 100, j == 0
                    // TD.innerHTML = Number(row) - i + 1;
                    TD.style.border = "transparent";
                    TD.style.paddingRight = "5px";
                    TD.style.textAlign = "center";
                    TD.style.verticalAlign = "bottom";

                    if (i == 0) {
                        // i == 0, j == 0
                        // TD.innerHTML = (Number(row) + 1) + "<sup>" + "A";
                        TD.style.textAlign = "right";
                        TD.style.verticalAlign = "bottom";
                    }
                } else {
                    if (i == 0) {
                        // i = 0, j = 0 ~ 100
                        TD.style.border = "transparent";
                        TD.style.paddingRight = "5px";
                        // TD.innerHTML = String.fromCharCode(65 + Number(j));
                        // if (TD.innerHTML > "H") {
                        //     TD.innerHTML = String.fromCharCode(66 + Number(j));
                        // }
                        TD.style.textAlign = "right";
                        TD.style.verticalAlign = "middle";
                    }
                }
                TR.appendChild(TD);
            }
            Table.appendChild(TR);
        }
        makeCloneTable(row, col);
    }

    function makeCloneTable(row, col) {
        for (let i = 0; i < Number(row) + 1; i++) {
            let TR = document.createElement('tr');

            for (let j = 0; j < Number(col) + 1; j++) {
                let TD = document.createElement('td');
                let Attr = document.createAttribute("class");
                
                Attr.value = "stone" + i + j;
                TD.setAttributeNode(Attr); 
                TD.style.border = "2px solid transparent";
                // TD.style.backgroundColor = "yellow";
                TD.style.borderRadius = "50px";
                TD.style.width = "25px";
                TD.style.height = "25px";
                
                if (j == 0) {
                    // i == 0, j = 0 ~ 100
                    TD.innerHTML = Number(row) - i + 1;
                    TD.style.border = "transparent";
                    TD.style.textAlign = "center";
                    TD.style.verticalAlign = "bottom";
                    TD.style.backgroundColor = "transparent";
                    TD.style.borderRadius = "0px";

                    if (i == 0) {  TD.innerHTML = "";  }
                    
                } else {
                    if (i == 0) {
                        // i = 0 ~ 100, j = 0
                        TD.style.border = "transparent";
                        TD.innerHTML = String.fromCharCode(64 + Number(j));
                        
                        if (TD.innerHTML > "H") {
                            TD.innerHTML = String.fromCharCode(65 + Number(j));
                        }
                        
                        TD.style.textAlign = "right";
                        TD.style.verticalAlign = "middle";
                        TD.style.backgroundColor = "transparent";
                        TD.style.borderRadius = "0px";
                    }
                }
                TR.appendChild(TD);
            }
            Table2.appendChild(TR);
        }
    };


    function setUserPlayTime(playTime) {
        getPlayTime = playTime;
    }

    function getUserPlayTime() {
        return getPlayTime;
    }
    
    // 화면 부분 display하는 함수
    function timeDisplay(playTime) {
        let pastTime = document.querySelector("#rightBottom2");
        let leftTime = document.querySelector("#rightBottom3");
        
        pastTime.textContent = "이번경과시간 : " + playTime + "초";
        leftTime.textContent = "남은시간 : " + Number(10 - playTime) + "초";
    }

    Table2.addEventListener("click", function(e) {
        let clickStone = e.target;
        let playTime = 0;
        
        if (clickStone.id != "Table2") {
            if (a) {
                clearInterval(a);
                playTime = 0;
            };
            
            a = setInterval(function() {
                // 화면 부분 display하는 함수
                timeDisplay(playTime);
                // **** 밖에서 playTime 을 가져다 쓸거기때문에 더하기 전에 값을 저장해야됨;
                setUserPlayTime(playTime);
                
                playTime++;
                
                
                if (playTime > 10) {
                    clearInterval(a);
                    playTime = 0;
                    // 화면 부분 display하는 함수
                    timeDisplay(playTime);
                    }
                }, 1000);
        
            // 조건문에 의해서 count가 홀수일때 흑돌, 짝수일때 백돌
            if (count % 2 != 0) {
                clickStone.style.backgroundColor = "black";
                clickStone.style.color = "white";
                blackStone.push(clickStone.className);
                console.log("black list:", blackStone);
                bkrudch += getUserPlayTime();
                console.log("흑돌누적시간",bkrudch);
                rightTop5.innerHTML = "흑돌소요시간 : " + bkrudch + "초";
                // return bkrudch;
            } else {
                clickStone.style.backgroundColor = "white";
                clickStone.style.borderColor = "black";
                clickStone.style.color = "black";
                whiteStone.push(clickStone.className);
                console.log("white list:", whiteStone);
                whrudch += getUserPlayTime();
                rightTop4.innerHTML = "백돌소요시간 : " + whrudch + "초";
                // return whrudch;
            }
            
            // 클릭한 오목판 위에 돌에 numbering 화 작업
            clickStone.innerHTML = count;
            
        } else {
            console.log("실패"); //1
        }
            
        count++;
        let totalStone = blackStone.concat(whiteStone);

        rightTop2.innerHTML = "백돌 : " + whiteStone.length + "개";
        rightTop3.innerHTML = "흑돌 : " + blackStone.length + "개";
        rightTop1.innerHTML = "놓여진 돌의 개수 : " + totalStone.length + "개";

        if (totalStone.length % 2 == 0) {
            rightBottom1.innerHTML = "순서 : 흑돌";
        } else {
            rightBottom1.innerHTML = "순서 : 백돌";
        }
    }); 

    //td가 중복해서 눌림. - 선택이 안되도록 변경.
    //지표부분이 눌림 - 안눌리게 막아야.

</script>
</body>

</html>
